function clearAll(a){_.each(a,function(b){b.empty()})}function setTransformPos(c,a,d){var b="translate("+a+"px,"+d+"px) translateZ(0)";c.style.transform=b;c.style["-ms-transform"]=b;c.style["-webkit-transform"]=b}function updateUserState(c,b,a){setTransformPos(b,a.worldX,a.worldY);if(a.done){c.addClass("leaving")}}function presentStats(d,g){var a=d.find(".transportedcounter").get(0),c=d.find(".elapsedtime").get(0),h=d.find(".transportedpersec").get(0),i=d.find(".avgwaittime").get(0),f=d.find(".maxwaittime").get(0),e=d.find(".movecount").get(0);g.on("stats_display_changed",function b(){a.textContent=g.transportedCounter;c.textContent=g.elapsedTime.toFixed(0)+"s";h.textContent=g.transportedPerSec.toPrecision(3);i.textContent=g.avgWaitTime.toFixed(1)+"s";f.textContent=g.maxWaitTime.toFixed(1)+"s";e.textContent=g.moveCount});g.trigger("stats_display_changed")}function presentChallenge(f,d,g,e,c,b,h){var a=$(riot.render(h,{challenge:d,num:b,timeScale:c.timeScale.toFixed(0)+"x",startButtonText:e.challengeEnded?"<i class='fa fa-repeat'></i> Restart":(c.isPaused?"Start":"Pause")}));f.html(a);f.find(".startstop").on("click",function(){g.startStopOrRestart()});f.find(".timescale_increase").on("click",function(j){j.preventDefault();if(c.timeScale<40){var i=Math.round(c.timeScale*1.618);c.setTimeScale(i)}});f.find(".timescale_decrease").on("click",function(j){j.preventDefault();var i=Math.round(c.timeScale/1.618);c.setTimeScale(i)})}function presentFeedback(d,f,c,e,b,a){d.html(riot.render(f,{title:e,message:b,url:a,paddingTop:c.floors.length*c.floorHeight*0.2}));if(!a){d.find("a").remove()}}function presentWorld(c,f,e,a,h,g){c.css("height",f.floorHeight*f.floors.length);c.append(_.map(f.floors,function(k){var i=$(riot.render(e,k));var l=i.find(".up");var j=i.find(".down");k.on("buttonstate_change",function(m){l.toggleClass("activated",m.up!=="");j.toggleClass("activated",m.down!=="")});l.on("click",function(){k.pressUpButton()});j.on("click",function(){k.pressDownButton()});return i}));c.find(".floor").first().find(".down").addClass("invisible");c.find(".floor").last().find(".up").addClass("invisible");function b(i){return _.map(i,function(j,k){return riot.render(h,{floorNum:k})}).join("")}function d(n){var i=$(riot.render(a,{e:n}));var k=i.get(0);i.find(".buttonindicator").html(b(n.buttonStates));var j=_.map(i.find(".buttonindicator").children(),function(r){return $(r)});var q=i.find(".floorindicator > span").get(0);i.on("click",".buttonpress",function(){n.pressFloorButton(parseInt($(this).text()))});n.on("new_display_state",function m(){setTransformPos(k,n.worldX,n.worldY)});n.on("new_current_floor",function l(r){q.textContent=r});n.on("floor_buttons_changed",function o(s,r){j[r].toggleClass("activated",s[r])});n.on("indicatorstate_change",function p(r){i.find(".up").toggleClass("activated",r.up);i.find(".down").toggleClass("activated",r.down)});n.trigger("new_state",n);n.trigger("new_display_state",n);n.trigger("new_current_floor",n.currentFloor);return i}c.append(_.map(f.elevators,function(i){return d(i)}));f.on("new_user",function(j){var k=$(riot.render(g,{u:j,state:j.done?"leaving":""}));var i=k.get(0);j.on("new_display_state",function(){updateUserState(k,i,j)});j.on("removed",function(){k.remove()});c.append(k)})}function presentCodeStatus(g,f,c){console.log(c);var d=c?"block":"none";var e=c?"none":"block";var b=c;if(c&&c.stack){b=c.stack;b=b.replace(/\n/g,"<br>")}var a=riot.render(f,{errorMessage:b,errorDisplay:d,successDisplay:e});g.html(a)}function makeDemoFullscreen(){$("body .container > *").not(".world").css("visibility","hidden");$("html, body, body .container, .world").css({width:"100%",margin:"0",padding:0})};